{% load i18n %}
{% load pagination_tags %}

{% if is_paginated %}
<nav class="pagination-wrapper" aria-label="{% trans 'Page navigation' %}">
  <ul class="pagination-list">

    {% if page_obj.has_previous %}
    <!-- First Page Button -->
    <li class="pagination-item">
      <a href="{% url_replace page=1 %}"
         class="pagination-link pagination-link-arrow"
         aria-label="{% trans 'First page' %}">
        <ion-icon name="chevron-back-outline"></ion-icon>
        <ion-icon name="chevron-back-outline"></ion-icon>
      </a>
    </li>

    <!-- Previous Page Button -->
    <li class="pagination-item">
      <a href="{% url_replace page=page_obj.previous_page_number %}"
         class="pagination-link pagination-link-arrow"
         aria-label="{% trans 'Previous page' %}">
        <ion-icon name="chevron-back-outline"></ion-icon>
      </a>
    </li>
    {% else %}
    <!-- Disabled First Page Button -->
    <li class="pagination-item">
      <span class="pagination-link pagination-link-arrow pagination-link-disabled" aria-disabled="true">
        <ion-icon name="chevron-back-outline"></ion-icon>
        <ion-icon name="chevron-back-outline"></ion-icon>
      </span>
    </li>

    <!-- Disabled Previous Page Button -->
    <li class="pagination-item">
      <span class="pagination-link pagination-link-arrow pagination-link-disabled" aria-disabled="true">
        <ion-icon name="chevron-back-outline"></ion-icon>
      </span>
    </li>
    {% endif %}

    <!-- Page Numbers -->
    {% for page_num in page_obj.paginator.page_range %}
      {% if page_num == page_obj.number %}
        <!-- Current Page (Active) -->
        <li class="pagination-item">
          <span class="pagination-link pagination-link-active" aria-current="page">{{ page_num }}</span>
        </li>
      {% elif page_num == 1 or page_num == page_obj.paginator.num_pages %}
        <!-- Always show first and last page -->
        <li class="pagination-item">
          <a href="{% url_replace page=page_num %}"
             class="pagination-link">{{ page_num }}</a>
        </li>
      {% elif page_num >= page_obj.number|add:'-2' and page_num <= page_obj.number|add:'2' %}
        <!-- Show 2 pages before and after current page -->
        <li class="pagination-item">
          <a href="{% url_replace page=page_num %}"
             class="pagination-link">{{ page_num }}</a>
        </li>
      {% elif page_num == page_obj.number|add:'-3' or page_num == page_obj.number|add:'3' %}
        <!-- Show ellipsis -->
        <li class="pagination-item">
          <span class="pagination-ellipsis">...</span>
        </li>
      {% endif %}
    {% endfor %}

    {% if page_obj.has_next %}
    <!-- Next Page Button -->
    <li class="pagination-item">
      <a href="{% url_replace page=page_obj.next_page_number %}"
         class="pagination-link pagination-link-arrow"
         aria-label="{% trans 'Next page' %}">
        <ion-icon name="chevron-forward-outline"></ion-icon>
      </a>
    </li>

    <!-- Last Page Button -->
    <li class="pagination-item">
      <a href="{% url_replace page=page_obj.paginator.num_pages %}"
         class="pagination-link pagination-link-arrow"
         aria-label="{% trans 'Last page' %}">
        <ion-icon name="chevron-forward-outline"></ion-icon>
        <ion-icon name="chevron-forward-outline"></ion-icon>
      </a>
    </li>
    {% else %}
    <!-- Disabled Next Page Button -->
    <li class="pagination-item">
      <span class="pagination-link pagination-link-arrow pagination-link-disabled" aria-disabled="true">
        <ion-icon name="chevron-forward-outline"></ion-icon>
      </span>
    </li>

    <!-- Disabled Last Page Button -->
    <li class="pagination-item">
      <span class="pagination-link pagination-link-arrow pagination-link-disabled" aria-disabled="true">
        <ion-icon name="chevron-forward-outline"></ion-icon>
        <ion-icon name="chevron-forward-outline"></ion-icon>
      </span>
    </li>
    {% endif %}

  </ul>

  <!-- Page Info -->
  <div class="pagination-info">
    <p>{% trans "Page" %} {{ page_obj.number }} {% trans "of" %} {{ page_obj.paginator.num_pages }}</p>
  </div>
</nav>
{% endif %}
