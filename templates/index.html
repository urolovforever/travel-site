{% extends 'base.html' %}
{% load static %}
{% load i18n %}
{% load i18n_tags %}

{% block title %}{% trans "Home" %} - Tourly Travel Agency{% endblock %}

{% block content %}

<!-- HERO -->
<section class="hero" id="home">
  <div class="container">
    <h2 class="h1 hero-title">{% trans "Journey to explore world" %}</h2>

    <p class="hero-text">
      {% trans "Discover amazing destinations and create unforgettable memories with our carefully curated travel packages." %}
    </p>

    <div class="btn-group">
      <a href="{% url 'core:about' %}" class="btn btn-primary">{% trans "Learn more" %}</a>
      <a href="{% url 'packages:package_list' %}" class="btn btn-secondary">{% trans "Book now" %}</a>
    </div>
  </div>
</section>

<!-- LANGUAGE SELECTOR SECTION -->
<section class="tour-search" style="background: var(--bright-navy-blue); padding: 40px 0;">
  <div class="container">
    <div style="display: flex; justify-content: center; align-items: center; gap: 30px; flex-wrap: wrap;">
      <h3 class="h3" style="color: white; margin: 0;">{% trans "Select Your Language" %}:</h3>

      <div class="language-selector-buttons" style="display: flex; gap: 15px; flex-wrap: wrap;">
        {% get_current_language as CURRENT_LANG %}
        {% get_available_languages as LANGUAGES %}
        {% for lang_code, lang_name in LANGUAGES %}
          <form action="{% url 'set_language' %}" method="post" style="display: inline;">
            {% csrf_token %}
            <input name="next" type="hidden" value="{{ request.get_full_path }}">
            <input name="language" type="hidden" value="{{ lang_code }}">
            <button type="submit" class="btn {% if CURRENT_LANG == lang_code %}btn-secondary{% else %}btn-outline{% endif %}" style="min-width: 120px; background: {% if CURRENT_LANG == lang_code %}var(--united-nations-blue){% else %}rgba(255,255,255,0.1){% endif %}; border: 2px solid white; color: white; font-weight: 600; padding: 12px 30px;">
              <ion-icon name="{% if lang_code == 'uz' %}flag{% elif lang_code == 'en' %}flag{% else %}flag{% endif %}" style="vertical-align: middle; margin-right: 5px;"></ion-icon>
              {{ lang_name }}
            </button>
          </form>
        {% endfor %}
      </div>
    </div>
  </div>
</section>

<!-- POPULAR DESTINATIONS -->
<section class="popular" id="destination">
  <div class="container">
    <p class="section-subtitle">{% trans "Uncover place" %}</p>

    <h2 class="h2 section-title">{% trans "Popular destinations" %}</h2>

    <p class="section-text">
      {% trans "Explore our most sought-after travel destinations around the world" %}
    </p>

    <ul class="popular-list">
      {% for destination in featured_destinations %}
        <li>
          <div class="popular-card">
            <figure class="card-img">
              {% if destination.main_image %}
                <img src="{{ destination.main_image.url }}" alt="{{ destination|get_translated:'title' }}" loading="lazy">
              {% else %}
                <img src="{% static 'images/popular-1.jpg' %}" alt="{{ destination|get_translated:'title' }}" loading="lazy">
              {% endif %}
            </figure>

            <div class="card-content">
              <div class="card-rating">
                <ion-icon name="star"></ion-icon>
                <ion-icon name="star"></ion-icon>
                <ion-icon name="star"></ion-icon>
                <ion-icon name="star"></ion-icon>
                <ion-icon name="star"></ion-icon>
              </div>

              <p class="card-subtitle">
                <a href="{% url 'destinations:destination_detail' destination.slug %}">{{ destination|get_translated:'title' }}</a>
              </p>

              <h3 class="h3 card-title">
                <a href="{% url 'destinations:destination_detail' destination.slug %}">{{ destination|get_translated:'short_description'|truncatewords:5 }}</a>
              </h3>

              <p class="card-text">
                {{ destination|get_translated:'description'|truncatewords:15 }}
              </p>
            </div>
          </div>
        </li>
      {% empty %}
        <li>
          <div class="popular-card">
            <figure class="card-img">
              <img src="{% static 'images/popular-1.jpg' %}" alt="Sample Destination" loading="lazy">
            </figure>
            <div class="card-content">
              <p class="card-text">{% trans "No destinations available. Please check back later." %}</p>
            </div>
          </div>
        </li>
      {% endfor %}
    </ul>

    <div style="text-align: center; margin-top: 50px;">
      <a href="{% url 'destinations:destination_list' %}" class="btn btn-primary" style="font-size: 14px; padding: 10px 30px;">{% trans "More destinations" %}</a>
    </div>
  </div>
</section>

<!-- PACKAGES -->
<section class="package" id="package">
  <div class="container">
    <p class="section-subtitle">{% trans "Popular Packages" %}</p>

    <h2 class="h2 section-title">{% trans "Checkout Our Packages" %}</h2>

    <p class="section-text">
      {% trans "Choose from our wide selection of carefully crafted tour packages" %}
    </p>

    <ul class="package-list">
      {% for package in featured_packages %}
        <li>
          <div class="package-card">
            <figure class="card-banner">
              {% if package.main_image %}
                <img src="{{ package.main_image.url }}" alt="{{ package|get_translated:'title' }}" loading="lazy">
              {% else %}
                <img src="{% static 'images/packege-1.jpg' %}" alt="{{ package|get_translated:'title' }}" loading="lazy">
              {% endif %}
            </figure>

            <div class="card-content">
              <h3 class="h3 card-title">{{ package|get_translated:'title' }}</h3>

              <p class="card-text">
                {{ package|get_translated:'description'|truncatewords:20 }}
              </p>

              <ul class="card-meta-list">
                <li class="card-meta-item">
                  <div class="meta-box">
                    <ion-icon name="time"></ion-icon>
                    <p class="text">{{ package|get_translated:'duration' }}</p>
                  </div>
                </li>

                <li class="card-meta-item">
                  <div class="meta-box">
                    <ion-icon name="people"></ion-icon>
                    <p class="text">{{ package.max_people }}+</p>
                  </div>
                </li>

                <li class="card-meta-item">
                  <div class="meta-box">
                    <ion-icon name="location"></ion-icon>
                    <p class="text">{{ package.destination|get_translated:'title' }}</p>
                  </div>
                </li>
              </ul>
            </div>

            <div class="card-price">
              <div class="wrapper">
                <p class="reviews">({{ package.bookings.count }} {% trans "reviews" %})</p>

                <div class="card-rating">
                  <ion-icon name="star"></ion-icon>
                  <ion-icon name="star"></ion-icon>
                  <ion-icon name="star"></ion-icon>
                  <ion-icon name="star"></ion-icon>
                  <ion-icon name="star"></ion-icon>
                </div>
              </div>

              <p class="price">
                {{ package.price }} {{ package.currency }}
                <span>/ {% trans "per person" %}</span>
              </p>

              <a href="{% url 'packages:package_detail' package.slug %}" class="btn btn-secondary">{% trans "Book Now" %}</a>
            </div>
          </div>
        </li>
      {% empty %}
        <li>
          <div class="package-card">
            <div class="card-content">
              <p class="card-text">{% trans "No packages available. Please check back later." %}</p>
            </div>
          </div>
        </li>
      {% endfor %}
    </ul>

    <div style="text-align: center; margin-top: 50px;">
      <a href="{% url 'packages:package_list' %}" class="btn btn-primary" style="font-size: 14px; padding: 10px 30px;">{% trans "View All Packages" %}</a>
    </div>
  </div>
</section>

<!-- GALLERY -->
<section class="gallery" id="gallery">
  <div class="container">
    <p class="section-subtitle">{% trans "Photo Gallery" %}</p>

    <h2 class="h2 section-title">{% trans "Photo's From Travellers" %}</h2>

    <p class="section-text">
      {% trans "Explore beautiful moments captured by our happy travelers" %}
    </p>

    <ul class="gallery-list">
      {% for image in latest_gallery_images %}
        <li class="gallery-item">
          <figure class="gallery-image">
            <img src="{{ image.image.url }}" alt="{{ image|get_translated:'caption' }}" loading="lazy">
          </figure>
        </li>
      {% empty %}
        {% for i in "12345" %}
          <li class="gallery-item">
            <figure class="gallery-image">
              <img src="{% static 'images/gallery-'|add:i|add:'.jpg' %}" alt="Gallery" loading="lazy">
            </figure>
          </li>
        {% endfor %}
      {% endfor %}
    </ul>

    <div style="text-align: center; margin-top: 50px;">
      <a href="{% url 'gallery:gallery' %}" class="btn btn-primary" style="font-size: 14px; padding: 10px 30px;">{% trans "View More" %}</a>
    </div>
  </div>
</section>

<!-- CTA -->
<section class="cta" id="contact">
  <div class="container">
    <div class="cta-content">
      <p class="section-subtitle">{% trans "Call To Action" %}</p>

      <h2 class="h2 section-title">{% trans "Ready For Unforgettable Travel. Remember Us!" %}</h2>

      <p class="section-text">
        {% trans "Contact us today to start planning your dream vacation" %}
      </p>
    </div>

    <a href="{% url 'core:contact' %}" class="btn btn-secondary">{% trans "Contact Us!" %}</a>
  </div>
</section>

{% endblock content %}
